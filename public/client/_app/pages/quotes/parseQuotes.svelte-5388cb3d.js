import{S as Ae,i as Te,s as Ce,e as N,k as Q,t as $,c as q,a as I,d as C,m as V,h as j,b as d,g as b,F as m,N as ae,O as K,al as oe,o as L,p as k,q as B,P as Se,Q as ie,v as Ne,n as w,L as Z,w as ue,x as fe,y as ce,B as pe,l as he,Z as qe}from"../../chunks/vendor-0f79dfe6.js";import{s as me,a as ge,q as Fe,b as De}from"../../chunks/quotes-d7d5baaa.js";import Pe from"./DisplayQuotes.svelte-fbdac828.js";import Ee from"./AddQuote.svelte-a4fe4203.js";/* empty css                                                             */const Ie=e=>{const t=e.filter(s=>s.value>-1);if(console.log("\u{1F680} ~ file: getMinNotFalse.js ~ line 4 ~ getMinNotFalse ~ charsFound",t),!t.length)return!1;let l={value:0};t.forEach(s=>{s.value>l.value&&(l=s)});let r=l;return t.forEach(s=>{s.value<r.value&&(r=s)}),console.log("\u{1F680} ~ file: getMinNotFalse.js ~ line 12 ~ getMinNotFalse ~ min",r),r},O=e=>{console.log("\u{1F680} ~ file: findNextSeparatingCharacter.js ~ line 4 ~ findNextSeparatingCharacter ~ text",e);let t=[{name:"title",openingChar:",",closingChar:",",value:!1},{name:"source",openingChar:"[",closingChar:"]",value:!1},{name:"axiom",openingChar:":",closingChar:"",value:!1},{name:"year",openingChar:"(",closingChar:")",value:!1},{name:"context",openingChar:"@",closingChar:")",value:!1},{name:"tags",openingChar:"#",closingChar:"",value:!1}];return t.forEach(l=>{l.value=e.indexOf(l.openingChar)}),Ie(t)},de=e=>{var n;let{author:t,remainingText:l}=e;e.author.name=t=l;let r=l.length;console.log("\u{1F680} ~ file: parseQuotes.js ~ line 60 ~ getQuoteAuthor ~ author",t),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 62 ~ getQuoteAuthor ~ remainingText",l),l&&l.includes("-")&&(console.log('\u{1F680} ~ file: getAuthor.js ~ line 12 ~ getAuthor ~ remainingText && remainingText.includes("-")',l&&l.includes("-")),t=l=l.split(/-(.+)/)[1],t=t.trim(),console.log("\u{1F680} ~ file: getAuthor.js ~ line 14 ~ getAuthor ~ author",t)),!t&&!l&&(t=l=(n=e.details[0])==null?void 0:n.value);let s=O(l);if(console.log("\u{1F680} ~ file: getAuthor.js ~ line 19 ~ getAuthor ~ separator",s),s.value>-1&&t){console.log("\u{1F680} ~ file: getAuthor.js ~ line 15 ~ getAuthor ~ remainingText",l),console.log("\u{1F680} ~ file: getAuthor.js ~ line 17 ~ getAuthor ~ author",t),l=l.trim();let a=l[0],i=l[s.value];console.log("\u{1F680} ~ file: getAuthor.js ~ line 19 ~ getAuthor ~ i1, i2, separator",a,i,s),t=Array.from(t).splice(0,s.value).join(String()).trim(),console.log("\u{1F680} ~ file: getAuthor.js ~ line 16 ~ getAuthor ~ author",t),l=Array.from(l).splice(s.value-2,r).join(String()).trim(),console.log("\u{1F680} ~ file: getAuthor.js ~ line 31 ~ getAuthor ~ remainingText",l),e.remainingText=l,e.author.name=t}else console.log("parse.js line:45 separator",s),e.author.name=t,e.remainingText=!1,e.parsingComplete=!0;let o=O(t);return o&&(e.author.name=t=t.split(o.openingChar)[0].trim(),console.log("\u{1F680} ~ file: getAuthor.js ~ line 46 ~ getAuthor ~ author",t)),console.log("\u{1F680} ~ file: getAuthor.js ~ line 44 ~ getAuthor ~ findNextSeparatingCharacter(author)",O(t)),e},xe=e=>(console.log("\u{1F680} ~ file: parseQuotes.js ~ line 4 ~ parse ~ workingQuoteObject",e),e.quoteBody||(console.log("\u{1F680} ~ file: parseQuotes.js ~ line 8 ~ parse ~ need quoteBody"),e=Be(e)),e.author.name||(console.log("\u{1F680} ~ file: parseQuotes.js ~ line 8 ~ parse ~ need author"),e=de(e)),e.parsingComplete||(e=Me(e),xe(e)),e);function Be(e){let{originalText:t,remainingText:l}=e,r,s,o,n;r=e.quoteBody=t,s=r.split('"'),o=s[1],n=s[2];let a=r.length,i=n.indexOf("-");return i=i>-1?i:0,n=Array.from(n).splice(i,a).join(String()).trim(),e.remainingText=n,e.quoteBody=o,e}function Me(e){console.log("\u{1F680} ~ file: parseQuotes.js ~ line 106 ~ parseNextDetail ~ workingQuoteObject",e);let{remainingText:t,nextPart:l}=e;if(!t)return e.parsingComplete=!0,console.log("\u{1F680} ~ file: parseQuotes.js ~ line 110 ~ parseNextDetail ~ workingQuoteObject['parsingComplete'] = true",!0),e;let r=W(t);return l=ee(t,r),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 97 ~ parseNextDetail ~ remainingText",t),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 97 ~ parseNextDetail ~ separatorValue",r),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 99 ~ parseNextDetail ~ nextPart",l),e=He(e,l,r),e}function Ue(e,t){let l,r,s;r=e.remainingText.trim();let o=r.split(/,(.+)/);o.length>1&&(l=o[1].trim(),e.author.title=l);let n=r.length;if(r=Array.from(r).splice(t+1,n).join(String()),t=W(r),s=ee(r,t),e.nextPart=s,s==="axiom"&&o!=="axiom"?e.parsingComplete=!0:e.parsingComplete=!1,s&&!e.parsingComplete?(l=Array.from(r).splice(1,t-1).join(String()).trim(),e.remainingText=r=Array.from(r).splice(t,n).join(String())):(l=r,r=!1),e.author.title=[...e.authorTitle,l],console.log("\u{1F680} ~ file: parseQuotes.js ~ line 109 ~ parseQuoteAuthorTitle ~ workingQuoteObject['author']['title'].length",e.author.title.length),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 109 ~ parseQuoteAuthorTitle ~ workingQuoteObject['author']['title']",e.author.title),e.author.title=l,Array.isArray(e.author.title)){let a=e.author.title.join(",").trim();console.log("\u{1F680} ~ file: parseQuotes.js ~ line 113 ~ parseQuoteAuthorTitle ~ str",a),e.author.title=a}return e.remainingText=r,e}function Re(e,t){let l,r,s;r=e.remainingText.trim();let o=r.length;return r=Array.from(r).splice(t+1,o).join(String()),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 165 ~ parseQuoteAxiom ~ text",r),t=W(r),s=ee(r,t),e.nextPart=s,s?(l=Array.from(r).splice(1,t-1).join(String()).trim(),r=Array.from(r).splice(t,o).join(String())):(l=r,r=!1),e.author.title=l.trim(),e.details.push({type:"Author title",value:l}),e.remainingText=r,e}function Le(e,t){let{remainingText:l}=e;l.trim();let r=l.length,s=Array.from(l).splice(t+1,r-t-2).join(String()),o=Ge(s);return console.log("\u{1F680} ~ file: parseQuotes.js ~ line 146 ~ parseQuoteDate ~ test",o),o?e.date=s:e.context=s,r-s.length,console.log("\u{1F680} ~ file: parse.js ~ line 193 ~ parseQuoteDate ~ date",s),l=Array.from(l).splice(t,r).join(String()),console.log("\u{1F680} ~ file: parse.js ~ line 195 ~ parseQuoteDate ~ remainingText",l),e.parsingComplete=!0,e}function Ge(e){return/\d/.test(e)}function Je(e,t){var a;let{remainingText:l}=e,r=e.remainingText.trim();console.log("\u{1F680} ~ file: parseQuotes.js ~ line 197 ~ parseQuoteSource ~ text",r),r.length,t=W(r);let s=t+1,o=_e(r,"]")-s,n=Array.from(r).splice(s,o).join(String()).trim();return s=n.length+2,console.log("\u{1F680} ~ file: parseQuotes.js ~ line 204 ~ parseQuoteSource ~ start",s),o=r.length-1,console.log("\u{1F680} ~ file: parseQuotes.js ~ line 206 ~ parseQuoteSource ~ end",o),l=Array.from(r).splice(s,o).join(String()).trim(),console.log("\u{1F680} ~ file: parse.js ~ line 284 ~ parseQuoteSource ~ remainingText",l),e.remainingText=l,e.source=n,(a=e==null?void 0:e.details)==null||a.push({type:"source",value:n}),console.log("\u{1F680} ~ file: parse.js ~ line 287 ~ parseQuoteSource ~ workingQuoteObject",e),e}function Ze(e,t){var a;let{remainingText:l}=e,r=l.trim();console.log("\u{1F680} ~ file: parseQuotes.js ~ line 222 ~ parseQuoteContext ~ text",r),W(r),_e(r,")");let s=r.split("(")[1]?r.split("(")[1]:r,o=s.split(")")[0]?s.split(")")[0]:s,n=s.split(")")[1]?s.split(")")[1].trim():!1;return n||(e.parsingComplete=!0),e.remainingText=n,e.context=o,(a=e==null?void 0:e.details)==null||a.push({type:"context",value:o}),console.log("\u{1F680} ~ file: parse.js ~ line 287 ~ parseQuoteContext ~ workingQuoteObject",e),e}function ze(e,t){var a,i;let{remainingText:l}=e,r=l.trim();console.log("\u{1F680} ~ file: parseQuotes.js ~ line 246 ~ parseQuoteTags ~ text",r),t=W(r),console.log("\u{1F680} ~ file: parse.js ~ line 255 ~ parseQuoteTags ~ separatorValue",t);let s=t+1,o=Ke(r,"#",s)-1,n;return o>-1?n=Array.from(r).splice(s,o).join(String()).trim():n=Array.from(r).splice(s,r.length).join(String()).trim(),s=n.length+1,o=r.length-1,l=Array.from(r).splice(s,o).join(String()).trim(),e.remainingText=l,(a=e.tags)==null||a.push(n),(i=e==null?void 0:e.details)==null||i.push({type:"tags",value:n}),e}function W(e){let t=[{name:"author",openingChar:"-",closingChar:"",value:!1},{name:"title",openingChar:",",closingChar:",",value:!1},{name:"source",openingChar:"[",closingChar:"]",value:!1},{name:"axiom",openingChar:":",closingChar:"",value:!1},{name:"year",openingChar:"(",closingChar:")",value:!1},{name:"context",openingChar:"@",closingChar:")",value:!1},{name:"tags",openingChar:"#",closingChar:"",value:!1}];return t.forEach(l=>{l.value=e.indexOf(l.openingChar)}),console.log(t),We(t)}function ee(e,t){switch(console.log("\u{1F680} ~ file: parseQuotes.js ~ line 286 ~ nameNextPartOfQuote ~ separatorValue",t),console.log("\u{1F680} ~ file: parseQuotes.js ~ line 286 ~ nameNextPartOfQuote ~ remainingText",e),e.charAt(t)){case",":return"authorTitle";case":":return"axiom";case"(":return"date";case"[":return"source";case"@":return"context";case"#":return"tags";default:return!1}}function He(e,t,l){switch(t){case"authorName":return de(e);case"authorTitle":return Ue(e,l);case"axiom":return Re(e,l);case"date":return Le(e,l);case"source":return Je(e,l);case"context":return Ze(e);case"tags":return ze(e,l);default:e.parsingComplete=!0;break}return e}function _e(e,t){return e.indexOf(t)}function Ke(e,t,l){return e.indexOf(t,l+1)}function We(e){const t=e.filter(r=>r.value>-1);return t.length?t.reduce((r,s)=>r>s.value?s.value:r,t[0].value):!1}function ye(e,t,l){const r=e.slice();return r[23]=t[l],r[25]=l,r}function Xe(e){let t,l,r,s;return{c(){t=N("button"),l=$("Add New Quote"),this.h()},l(o){t=q(o,"BUTTON",{class:!0});var n=I(t);l=j(n,"Add New Quote"),n.forEach(C),this.h()},h(){d(t,"class","p-4 rounded bg-indigo-600 m-3")},m(o,n){b(o,t,n),m(t,l),r||(s=K(t,"click",e[8]),r=!0)},p:Z,i:Z,o:Z,d(o){o&&C(t),r=!1,s()}}}function Ye(e){let t,l;return t=new Ee({}),{c(){ue(t.$$.fragment)},l(r){fe(t.$$.fragment,r)},m(r,s){ce(t,r,s),l=!0},p:Z,i(r){l||(B(t.$$.fragment,r),l=!0)},o(r){L(t.$$.fragment,r),l=!1},d(r){pe(t,r)}}}function Qe(e){let t;return{c(){t=$("loading...")},l(l){t=j(l,"loading...")},m(l,r){b(l,t,r)},p:Z,i:Z,o:Z,d(l){l&&C(t)}}}function Ve(e){let t,l,r=e[0],s=[];for(let n=0;n<r.length;n+=1)s[n]=ve(ye(e,r,n));const o=n=>L(s[n],1,1,()=>{s[n]=null});return{c(){for(let n=0;n<s.length;n+=1)s[n].c();t=he()},l(n){for(let a=0;a<s.length;a+=1)s[a].l(n);t=he()},m(n,a){for(let i=0;i<s.length;i+=1)s[i].m(n,a);b(n,t,a),l=!0},p(n,a){if(a&1){r=n[0];let i;for(i=0;i<r.length;i+=1){const p=ye(n,r,i);s[i]?(s[i].p(p,a),B(s[i],1)):(s[i]=ve(p),s[i].c(),B(s[i],1),s[i].m(t.parentNode,t))}for(w(),i=r.length;i<s.length;i+=1)o(i);k()}},i(n){if(!l){for(let a=0;a<r.length;a+=1)B(s[a]);l=!0}},o(n){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)L(s[a]);l=!1},d(n){qe(s,n),n&&C(t)}}}function ve(e){let t,l;return t=new Pe({props:{quote:e[23],i:e[25]}}),{c(){ue(t.$$.fragment)},l(r){fe(t.$$.fragment,r)},m(r,s){ce(t,r,s),l=!0},p(r,s){const o={};s&1&&(o.quote=r[23]),t.$set(o)},i(r){l||(B(t.$$.fragment,r),l=!0)},o(r){L(t.$$.fragment,r),l=!1},d(r){pe(t,r)}}}function $e(e){let t,l,r,s,o,n,a,i,p,c,f,F,x,D,X,P,G,Y,E,y,v,u,h,_;const J=[Ye,Xe],S=[];function M(T,g){return T[4]?0:1}c=M(e),f=S[c]=J[c](e);const A=[Ve,Qe],U=[];function te(T,g){return T[1].length?0:1}return y=te(e),v=U[y]=A[y](e),{c(){t=N("div"),l=N("div"),r=N("div"),s=N("input"),o=Q(),n=N("div"),a=N("input"),i=Q(),p=N("div"),f.c(),F=Q(),x=N("button"),D=$("Re-parse quotes file"),X=Q(),P=N("button"),G=$("Get dgraph quotes"),Y=Q(),E=N("div"),v.c(),this.h()},l(T){t=q(T,"DIV",{class:!0});var g=I(t);l=q(g,"DIV",{class:!0});var R=I(l);r=q(R,"DIV",{class:!0});var z=I(r);s=q(z,"INPUT",{class:!0,id:!0,type:!0}),z.forEach(C),o=V(R),n=q(R,"DIV",{class:!0});var le=I(n);a=q(le,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),le.forEach(C),R.forEach(C),i=V(g),p=q(g,"DIV",{class:!0});var H=I(p);f.l(H),F=V(H),x=q(H,"BUTTON",{class:!0});var re=I(x);D=j(re,"Re-parse quotes file"),re.forEach(C),X=V(H),P=q(H,"BUTTON",{class:!0});var se=I(P);G=j(se,"Get dgraph quotes"),se.forEach(C),H.forEach(C),Y=V(g),E=q(g,"DIV",{class:!0});var ne=I(E);v.l(ne),ne.forEach(C),g.forEach(C),this.h()},h(){d(s,"class","input input-primary w-48 p-0 border-2 border-indigo-600 svelte-ad6nk5"),d(s,"id","fileInput"),d(s,"type","file"),d(r,"class","fileinput-wrapper ml-12"),d(a,"type","text"),d(a,"id","filterTextBar"),d(a,"placeholder","Search quotes"),d(a,"class","w-5/6 input input-primary rounded-md text-lg p-4 border-2 border-indigo-600 active:border-sky-300"),d(n,"class","flex w-full items-center justify-start m-0 ml-8"),d(l,"class","file-and-search-wrapper flex items-start justify-center mt-12"),d(x,"class","p-4 rounded bg-indigo-600 m-3"),d(P,"class","p-4 rounded bg-indigo-600 m-3"),d(p,"class","flex w-full"),d(E,"class","quotes svelte-ad6nk5"),d(t,"class","quotes-wrapper flex flex-col w-full bg-black svelte-ad6nk5")},m(T,g){b(T,t,g),m(t,l),m(l,r),m(r,s),m(l,o),m(l,n),m(n,a),ae(a,e[2]),m(t,i),m(t,p),S[c].m(p,null),m(p,F),m(p,x),m(x,D),m(p,X),m(p,P),m(P,G),m(t,Y),m(t,E),U[y].m(E,null),u=!0,h||(_=[K(s,"change",e[13]),K(s,"change",function(){oe(e[6](e[5]))&&e[6](e[5]).apply(this,arguments)}),K(a,"input",e[14]),K(x,"click",function(){oe(e[7](e[3]))&&e[7](e[3]).apply(this,arguments)}),K(P,"click",be)],h=!0)},p(T,[g]){e=T,g&4&&a.value!==e[2]&&ae(a,e[2]);let R=c;c=M(e),c===R?S[c].p(e,g):(w(),L(S[R],1,1,()=>{S[R]=null}),k(),f=S[c],f?f.p(e,g):(f=S[c]=J[c](e),f.c()),B(f,1),f.m(p,F));let z=y;y=te(e),y===z?U[y].p(e,g):(w(),L(U[z],1,1,()=>{U[z]=null}),k(),v=U[y],v?v.p(e,g):(v=U[y]=A[y](e),v.c()),B(v,1),v.m(E,null))},i(T){u||(B(f),B(v),u=!0)},o(T){L(f),L(v),u=!1},d(T){T&&C(t),S[c].d(),U[y].d(),h=!1,Se(_)}}}function je(e){let t="";return e.length>1?(e.forEach(l=>{t+=`${l}<br>`}),t):(t="",e[0])}function be(){(async()=>{try{const t=await fetch('/quotes.dgraph.getQuote?queryType="getAllQuotes"');if(console.log("\u{1F680} ~ file: DisplayQuotes.svelte ~ line 24 ~ fire ~ res",t),t.ok){const{dgraph_quotes:l}=await t.json();return console.log("\u{1F680} ~ file: AddQuote.svelte ~ line 53 ~ load ~ dgraph_quotes",l),{props:{dgraph_quotes:l}}}}catch(t){return console.log("\u{1F680} ~ DisplayQuotes called getQuote.json endpoint: error",t),{body:{error:"There was a server error"}}}})()}function ke(e,t,l){let r,s;ie(e,Fe,u=>l(11,r=u)),ie(e,De,u=>l(12,s=u));let o,n,a=!1,i=!1,p=[],c="",f=[],F="",{filteredQuotes:x=[]}=t,D=[];Ne(()=>{l(9,o=localStorage.getItem("fileContent")),l(10,n=localStorage.getItem("quotesArray"))});function X(u){if(u){console.log("\u{1F680} ~ file: parseQuotes.svelte ~ line 14 ~ readFile ~ input_file",u[0]),l(3,a=u[0]);var h=new FileReader;h.onload=function(_){c=_.target.result,console.log("Successfully read file"),me.set(c),G(c)},h.onerror=function(_){console.error("Failed to read file",_)},h.readAsText(a)}}function P(u){if(console.log("\u{1F680} ~ file: parseQuotes.svelte ~ line 87 ~ reParseFile ~ reParseFile, input_file",u),localStorage.setItem("quotesArray",[]),u){console.log("\u{1F680} ~ file: parseQuotes.svelte ~ line 14 ~ reParseFile ~ input_file",u[0]),l(3,a=u[0]);var h=new FileReader;h.onload=function(_){c=_.target.result,console.log("Successfully read file"),me.set(c),G(c)},h.onerror=function(_){console.error("Failed to read file",_)},h.readAsText(a)}}function G(u){let J=new DOMParser().parseFromString(u,"text/html").getElementsByTagName("div");D=Y(J);for(let S=0;S<D.length;S++){let M=je(D[S]);(M.includes("\\r")||M.includes("\\n"))&&(M=M.replace(/(\\r\\n|\\n|\\r)/gm,""));let A={};A.originalText=A.remainingText=M,A.details=[],A.author={name:"",title:""},A.authorTitle=[],A.title="",A.tags=[],A.sources=[],A=xe(A),l(1,f=[...f,A])}ge.set(f)}function Y(u){let h=[];for(let _=0;_<u.length;_++){let J=u[_];J.innerText.length>5?h=[...h,J.innerText]:(D=[...D,h],h=[])}return D}function E(){l(4,i=!0)}function y(){p=this.files,l(5,p)}function v(){F=this.value,l(2,F)}return e.$$set=u=>{"filteredQuotes"in u&&l(0,x=u.filteredQuotes)},e.$$.update=()=>{e.$$.dirty&7682&&o&&(n?(l(0,x=l(1,f=JSON.parse(n))),console.log("\u{1F680} ~ file: parseQuotes.svelte ~ line 28 ~ quotes",f),ge.set(f),l(0,x=[...s,...r])):G(o)),e.$$.dirty&6150&&(l(0,x=[...s,...r]),F?l(0,x=f.filter(u=>u.originalText.toLowerCase().includes(F.toLowerCase()))):l(0,x=[...s,...r]))},[x,f,F,a,i,p,X,P,E,o,n,r,s,y,v]}class rt extends Ae{constructor(t){super();Te(this,t,ke,$e,Ce,{filteredQuotes:0})}}export{rt as default};
